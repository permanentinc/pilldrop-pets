{% comment %}
  Simplified facets - tags grouped by category
  Usage: {% render 'facets', results: collection %}
{% endcomment %}

{%- liquid
  assign brand_tags = 'Mellitus,Brand2,Brand3' | split: ','
  assign animal_tags = 'Cats,Dogs,Horses' | split: ','
  assign condition_tags = 'Skin,Cardiac,Diabetes' | split: ','

  if results.url
    assign results_url = results.url
  else
    assign terms = results.terms | escape
    assign results_url = '?q=' | append: terms
  endif
-%}

<div class="facets-simple">
  <div class="product-count">
    <span id="ProductCount">
      {%- if results.results_count -%}
        {{ 'templates.search.results_with_count' | t: terms: results.terms, count: results.results_count }}
      {%- elsif results.products_count == results.all_products_count -%}
        {{ 'products.facets.product_count_simple' | t: count: results.products_count }}
      {%- else -%}
        {{
          'products.facets.product_count'
          | t: product_count: results.products_count, count: results.all_products_count
        }}
      {%- endif -%}
    </span>
  </div>

  <facet-filters-form>
    <form id="FacetFiltersForm">
      <div class="filter-group">
        <input
          type="hidden"
          id="search-query"
          name="q"
          value="{{ results.terms | escape }}"
          placeholder="Search products..."
        >
      </div>

      {%- for filter in results.filters -%}
        {%- if filter.type == 'list' and filter.label == 'Tags' -%}
          <div class="filter-group">
            <h3>Condition</h3>
            {%- for value in filter.values -%}
              {%- if condition_tags contains value.label -%}
                <label>
                  <input
                    type="checkbox"
                    class="check"
                    name="{{ value.param_name }}"
                    value="{{ value.value }}"
                    {% if value.active %}
                      checked
                    {% endif %}
                  >
                  {{ value.label }} ({{ value.count }})
                </label>
              {%- endif -%}
            {%- endfor -%}
          </div>
        {%- endif -%}
      {%- endfor -%}

      <div class="filter-group">
        <h3>All</h3>
        {%- for filter in results.filters -%}
          {%- if filter.type == 'list' -%}
            {%- for value in filter.values -%}
              <label>
                <input
                  type="checkbox"
                  class="check"
                  name="{{ value.param_name }}"
                  value="{{ value.value }}"
                  {% if value.active %}
                    checked
                  {% endif %}
                >
                {{ value.label }} ({{ value.count }})
              </label>
            {%- endfor -%}
          {%- endif -%}
        {%- endfor -%}
      </div>

      <a href="{{ results_url }}">Clear all</a>
    </form>
  </facet-filters-form>
</div>
